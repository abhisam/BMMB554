<!doctype html>

<html lang="en-us">

<head>
  <title>BMMB 554 | 2018</title>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="description" content="The HTML5 Herald" />
  <meta name="author" content="Anton Nekrutenko" />
  <meta name="generator" content="Hugo 0.32.3" />
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/normalize/7.0.0/normalize.min.css" />
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css" />
  <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto+Slab|Ruda" />
  <link rel="stylesheet" type="text/css" href="https://nekrut.github.io/BMMB554/css/styles.css" />
</head>

<body>
  <div id="container">
    <header>
      <h1>
                <a href="https://nekrut.github.io/BMMB554/">BMMB 554 | 2018</a>
            </h1>

      <ul id="social-media">
        
        <li><a href="https://twitter.com/galaxyproject"><i class="fa fa-twitter fa-lg" aria-hidden="true"></i></a></li>
          
        <li><a href="https://github.com/nekrut"><i class="fa fa-github fa-lg" aria-hidden="true"></i></a></li>
           
      </ul>
      
      <p><em>Introduction to data driven life sciences</em></p>
      
    </header>

    
<nav>
    <ul>
        
        <li>
            <a class="" href="https://nekrut.github.io/BMMB554/about/">
                <i class="fa-li fa  fa-lg"></i><span>Syllabus</span>
            </a>
        </li>
        
        <li>
            <a class="" href="https://nekrut.github.io/BMMB554/posts/">
                <i class="fa-li fa  fa-lg"></i><span>Lectures</span>
            </a>
        </li>
        
    </ul>
</nav>

    <main>




<article>

    <h1>Diving into analyses</h1>

    
        <aside>
    <ul>
        <li>
            <time class="post-date" datetime="2018-02-21T00:00:00Z">Feb 21, 2018</time>
        </li>
        
        

        
        <li>
            <em>
                
                    
                    <a href="https://nekrut.github.io/BMMB554/tags/docker/">#docker</a>
                
                    , 
                    <a href="https://nekrut.github.io/BMMB554/tags/conda/">#conda</a>
                
                    , 
                    <a href="https://nekrut.github.io/BMMB554/tags/mapping/">#mapping</a>
                
                    , 
                    <a href="https://nekrut.github.io/BMMB554/tags/variant-calling/">#variant calling</a>
                
                    , 
                    <a href="https://nekrut.github.io/BMMB554/tags/bwa/">#bwa</a>
                
                    , 
                    <a href="https://nekrut.github.io/BMMB554/tags/freebayes/">#freebayes</a>
                
            </em>
        </li>
        

        <li>4 min read</li>
    </ul>
</aside>
    

    

<h1 id="setting-up-jupyter">Setting up Jupyter</h1>

<p>For our analyses we will be using <a href="http://jupyter.org/">Jupyter</a>. The problem is that everyone in this class has a different computer setup, which may cause issues with running Jupyter. We will solve this using <a href="https://www.docker.com/">Docker</a> - a lightweight virtualization solution that run equally well on Mac, Windows, and Linux:</p>

<blockquote>
<p>Docker provides the ability to package and run an application in a loosely isolated environment called a container. The isolation and security allow you to run many containers simultaneously on a given host. Containers are lightweight because they don’t need the extra load of a hypervisor, but run directly within the host machine’s kernel. This means you can run more containers on a given hardware combination than if you were using virtual machines. You can even run Docker containers within host machines that are actually virtual machines!</p>
</blockquote>

<p>This tutorial uses MacOS as an example, but other platforms should have similar logic.</p>

<h2 id="1-download-and-install-docker">1. Download and Install Docker</h2>

<p>First, we need to download and install application that will allow us to instantiate Docker containers.</p>

<ul>
<li>Go to <a href="https://www.docker.com/community-edition">Docker Community Edition</a> and download Docker CE for your OS.<br /></li>
<li>Double click on <code>Docker.dmg</code> file</li>
</ul>

<table>
<thead>
<tr>
<th></th>
</tr>
</thead>

<tbody>
<tr>
<td><img src="https://nekrut.github.io/BMMB554/img/docker_install.png" alt="" /></td>
</tr>

<tr>
<td><small>Drag docker to you Applications folder</small></td>
</tr>
</tbody>
</table>

<ul>
<li>Go to &ldquo;Applications&rdquo;, start it, and go through all prompts</li>
<li>You know it is running because you will have Docker icon</li>
</ul>

<table>
<thead>
<tr>
<th></th>
</tr>
</thead>

<tbody>
<tr>
<td><img src="https://nekrut.github.io/BMMB554/img/docker_menu_bar.png" alt="" /></td>
</tr>

<tr>
<td><small>It&rsquo;s running</small></td>
</tr>
</tbody>
</table>

<h2 id="2-start-kitematic">2. Start Kitematic</h2>

<p>Kitematic is a GUI for Docker.</p>

<ul>
<li>start Kitematic by clicking on Docker icon on the menu bar:</li>
</ul>

<table>
<thead>
<tr>
<th></th>
</tr>
</thead>

<tbody>
<tr>
<td><img src="https://nekrut.github.io/BMMB554/img/start_kitematic.png" alt="" /></td>
</tr>

<tr>
<td><small>Start Kitematic</small></td>
</tr>
</tbody>
</table>

<ul>
<li>you will see something like this:</li>
</ul>

<table>
<thead>
<tr>
<th></th>
</tr>
</thead>

<tbody>
<tr>
<td><img src="https://nekrut.github.io/BMMB554/img/kitematic_window.png" alt="" /></td>
</tr>

<tr>
<td><small>Kitematic is running</small></td>
</tr>
</tbody>
</table>

<h2 id="3-download-jupyter">3. Download Jupyter</h2>

<p>We will use special &ldquo;flavor&rdquo; of Jupyter - a Docker image containing Jupyter and many popular data analysis tools - <a href="https://github.com/jupyter/docker-stacks/tree/master/datascience-notebook">Jupyter Notebook Data Science Stack</a>. To do this type <code>jupyter/datascience-notebook</code> in your Kitematic window:</p>

<table>
<thead>
<tr>
<th></th>
</tr>
</thead>

<tbody>
<tr>
<td><img src="https://nekrut.github.io/BMMB554/img/getting_jp.png" alt="" /></td>
</tr>

<tr>
<td><small>Finding <code>jupyter/datascience-notebook</code> image</small></td>
</tr>
</tbody>
</table>

<p>and then click <strong>CREATE</strong> button by <code>datascience-notebook</code>:</p>

<table>
<thead>
<tr>
<th></th>
</tr>
</thead>

<tbody>
<tr>
<td><img src="https://nekrut.github.io/BMMB554/img/getting_jp1.png" alt="" /></td>
</tr>

<tr>
<td><small>Downloading <code>jupyter/datascience-notebook</code> image</small></td>
</tr>
</tbody>
</table>

<p>wait for it to download! It will take some time.</p>

<h2 id="4-start-jupyter-notebook">4. Start Jupyter Notebook</h2>

<p>After Jupyter image is downloaded, the container will start automatically:</p>

<table>
<thead>
<tr>
<th></th>
</tr>
</thead>

<tbody>
<tr>
<td><img src="https://nekrut.github.io/BMMB554/img/running_jp1.png" alt="" /></td>
</tr>

<tr>
<td><small>Downloading <code>jupyter/datascience-notebook</code> image</small></td>
</tr>
</tbody>
</table>

<p>This is, however, something we <font color="red"><strong>DO NOT WANT</strong></font>! This is because we want to configure the container to have access to the filesystem of your computer.</p>

<p>So first go ahead and create a directory somewhere on your filesystem. This is important because you will store your data and notebook copies in that place:</p>

<pre><code>$ cd
$ pwd
/Users/anton
$ mkdir bmmb554_sandbox
$ cd bmmb554_sandbox
</code></pre>

<p>Next, stop the running container using Kitematic interface:</p>

<table>
<thead>
<tr>
<th></th>
</tr>
</thead>

<tbody>
<tr>
<td><img src="https://nekrut.github.io/BMMB554/img/stop_jp.png" alt="" /></td>
</tr>

<tr>
<td><small>Stop running container</small></td>
</tr>
</tbody>
</table>

<p>Then click <strong>DOCKER CLI</strong> (stands for Docker Command Line Interface) at the bottom of Kitematic window:</p>

<table>
<thead>
<tr>
<th></th>
</tr>
</thead>

<tbody>
<tr>
<td><img src="https://nekrut.github.io/BMMB554/img/docker_cli.png" alt="" /></td>
</tr>

<tr>
<td><small>Open DOCKER shell</small></td>
</tr>
</tbody>
</table>

<p>in the shell type (obviously omit <code>$</code> as these simply indicate shell prompt and replace <code>/Users/anton/bmmb554_sandbox</code> with directory you created above):</p>

<pre><code>$ run -v /Users/anton/bmmb554_sandbox:/home/jovyan/work -it --rm -p 8888:8888 jupyter/datascience-notebook
</code></pre>

<p>when Container starts it will spit something like this:</p>

<pre><code>[I 17:47:18.891 NotebookApp] Use Control-C to stop this server and shut down all kernels (twice to skip confirmation).
[C 17:47:18.891 NotebookApp] 
    
    Copy/paste this URL into your browser when you connect for the first time,
    to login with a token:
        http://localhost:8888/?token=90e426ee66686351a303a030093d9fd094bd700f41e07d94
</code></pre>

<p>just copy this URL into your browser and you will get a running Jupyter server:</p>

<table>
<thead>
<tr>
<th></th>
</tr>
</thead>

<tbody>
<tr>
<td><img src="https://nekrut.github.io/BMMB554/img/its_running.png" alt="" /></td>
</tr>

<tr>
<td><small>Jupyter is now running</small></td>
</tr>
</tbody>
</table>

<p>you will notice that the image above simply shows a file browser interface. If you click on <code>work</code> you will see an empty directory. However, because we started our Docker container with <code>-v /Users/anton/bmmb554_sandbox:/home/jovyan/work</code> flag, we are actually looking inside <code>/Users/anton/bmmb554_sandbox</code> directory on my machine. But from the standpoint of Docker container it is in <code>/home/jovyan/work</code>. (If you wonder what <code>jovyan</code> means <a href="https://github.com/jupyter/docker-stacks/issues/358">look here</a>).</p>

<h1 id="setting-up-github">Setting up GitHub</h1>

<h2 id="create-a-github-account">Create a GitHub account</h2>

<p>Don&rsquo;t call it anything stupid. You will likely use GitHub a lot in the future!</p>

<h2 id="create-a-new-repository">Create a new repository</h2>

<table>
<thead>
<tr>
<th></th>
</tr>
</thead>

<tbody>
<tr>
<td><img src="https://nekrut.github.io/BMMB554/img/create_repo.png" alt="" /></td>
</tr>

<tr>
<td><small>Create new repository on GitHub</small></td>
</tr>
</tbody>
</table>

<h2 id="copy-repo-link">Copy repo link</h2>

<table>
<thead>
<tr>
<th></th>
</tr>
</thead>

<tbody>
<tr>
<td><img src="https://nekrut.github.io/BMMB554/img/copy_repo_link.png" alt="" /></td>
</tr>

<tr>
<td><small>Copy link to your newly minted repo</small></td>
</tr>
</tbody>
</table>

<h2 id="get-back-to-kitematic">Get back to Kitematic</h2>

<p>Open Shell within your running container:</p>

<table>
<thead>
<tr>
<th></th>
</tr>
</thead>

<tbody>
<tr>
<td><img src="https://nekrut.github.io/BMMB554/img/start_container_shell.png" alt="" /></td>
</tr>

<tr>
<td><small>Click <strong>EXEC</strong> button</small></td>
</tr>
</tbody>
</table>

<p>within that shell type:</p>

<pre><code>jovyan@5373fde36475:~$ ls
work
jovyan@5373fde36475:~$ cd work/
jovyan@5373fde36475:~/work$ git clone https://github.com/nekrut/bmmb554_notebooks.git
Cloning into 'bmmb554_notebooks'...
remote: Counting objects: 3, done.
remote: Compressing objects: 100% (2/2), done.
remote: Total 3 (delta 0), reused 0 (delta 0), pack-reused 0
Unpacking objects: 100% (3/3), done.
Checking connectivity... done.
jovyan@5373fde36475:~/work$ 

</code></pre>

<p>Now create a directory for your data, where you will be storing actual datasets. <font color="red">It must be outside of your git repo as you don&rsquo;t want to commit these large files:</font></p>

<pre><code>jovyan@5373fde36475:~/work$ mkdir data
</code></pre>

<p>Now, you have the following structure for your filesystem:</p>

<pre><code>.
├── bmmb554_notebooks
│   └── README.md
└── data
</code></pre>

<p>Your notebooks will go to <code>bmmb554_notebooks</code> and data will do <code>data</code>.</p>


</article>


<section class="post-nav">
    <ul>
        
        <li>
            <a href="https://nekrut.github.io/BMMB554/posts/topic9/"><i class="fa fa-chevron-circle-left"></i> Variant calling: Pooled and Haploid systems</a>
        </li>
        
        
    </ul>
</section>
    





</main>
    <footer>
        <h6>Anton Nekrutenko | 2018 | CC-BY </h6>
    </footer>
</div>
<script src="https://nekrut.github.io/BMMB554/js/scripts.js"></script>
<script type="text/javascript" async
  src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML">
  MathJax.Hub.Config({
  tex2jax: {
    inlineMath: [['$','$'], ['\\(','\\)']],
    displayMath: [['$$','$$']],
    processEscapes: true,
    processEnvironments: true,
    skipTags: ['script', 'noscript', 'style', 'textarea', 'pre'],
    TeX: { equationNumbers: { autoNumber: "AMS" },
         extensions: ["AMSmath.js", "AMSsymbols.js"] }
  }
  });
  MathJax.Hub.Queue(function() {
    
    
    
    var all = MathJax.Hub.getAllJax(), i;
    for(i = 0; i < all.length; i += 1) {
        all[i].SourceElement().parentNode.className += ' has-jax';
    }
  });

  MathJax.Hub.Config({
  
  TeX: { equationNumbers: { autoNumber: "AMS" } }
  });
</script>

</body>
</html>


